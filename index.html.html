<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SimuVerse Simulation Platform</title>
    <link rel="stylesheet" href="style.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    </head>
<body>
    <div id="loginPage" class="page active">
        <div class="login-container">
            <div class="login-card">
                <div class="login-header">
                    <div class="logo">
                        <i class="fas fa-graduation-cap"></i>
                        <h1>SimuVerse</h1>
                    </div>
                    <p class="tagline">&lt;insert your tagline here&gt;</p>
                </div>
                <form id="loginForm" class="login-form">
                    <div class="form-group">
                        <label for="username" class="form-label">Username</label>
                        <input type="text" id="username" class="form-control" placeholder="Enter your username" required>
                    </div>
                    <div class="form-group">
                        <label for="password" class="form-label">Password</label>
                        <input type="password" id="password" class="form-control" placeholder="Enter your password" required>
                    </div>
                    <button type="submit" class="btn btn--primary btn--full-width">Sign In</button>
                    <div id="loginError" class="error-message hidden"></div>
                </form>
                <div class="login-footer">
                    <p>Interactive Simulation Platform</p>
                </div>
            </div>
        </div>
    </div>

    <div id="lobbyPage" class="page">
        <div class="container">
            <div class="lobby-header">
                <div class="logo-small">
                    <i class="fas fa-graduation-cap"></i>
                    <span>SimuVerse</span>
                </div>
                <div class="user-info">
                    <span id="currentUser"></span>
                    <button id="logoutBtn" class="btn btn--secondary">
                        <i class="fas fa-sign-out-alt"></i> Logout
                    </button>
                </div>
            </div>
            
            <div class="lobby-content">
                <div class="lobby-main">
                    <div class="lobby-status">
                        <div class="status-card">
                            <div class="status-icon waiting">
                                <i class="fas fa-clock"></i>
                            </div>
                            <div class="status-text">
                                <h2>Waiting for Session to Begin</h2>
                                <p>Please wait while the session administrator prepares to start the consulting simulation.</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="online-users">
                        <h3>
                            <i class="fas fa-users"></i>
                            Online Participants
                            <span id="onlineCount" class="count-badge">0</span>
                        </h3>
                        <div id="onlineUsersList" class="users-grid">
                            </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="dashboardPage" class="page">
        <div class="container dashboard-container">
            <div class="dashboard-header">
                <div class="header-left">
                    <div class="logo-small">
                        <i class="fas fa-graduation-cap"></i>
                        <span>SimuVerse</span>
                    </div>
                    <div class="project-info">
                        <div class="client-name" id="clientName">Waiting for Assignment</div>
                        <div class="project-type" id="projectType">Project Setup Pending</div>
                    </div>
                </div>
                
                <div class="header-right">
                    <div class="session-time">
                        <i class="fas fa-clock"></i>
                        <span id="sessionTimer">09:00 AM - 02:00 PM</span>
                    </div>
                    <div class="user-info">
                        <span id="dashboardUser"></span>
                        <button id="dashboardLogout" class="btn btn--secondary">
                            <i class="fas fa-sign-out-alt"></i>
                        </button>
                    </div>
                </div>
            </div>

            <div class="dashboard-content">
                <div class="dashboard-left">
                    <div class="widget project-overview">
                        <div class="widget-header">
                            <h3><i class="fas fa-briefcase"></i> Project Overview</h3>
                        </div>
                        <div class="widget-content">
                            <div class="project-details">
                                <div class="detail-item">
                                    <span class="label">Client:</span>
                                    <span class="value" id="projectClient">Pending Assignment</span>
                                </div>
                                <div class="detail-item">
                                    <span class="label">Industry:</span>
                                    <span class="value" id="projectIndustry">TBD</span>
                                </div>
                                <div class="detail-item">
                                    <span class="label">Challenge:</span>
                                    <span class="value" id="projectChallenge">Awaiting Faculty Setup</span>
                                </div>
                                <div class="project-description" id="projectDescription">
                                    Please wait while the faculty sets up the project parameters and team assignments.
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="widget timeline-progress">
                        <div class="widget-header">
                            <h3><i class="fas fa-chart-line"></i> Timeline & Progress</h3>
                        </div>
                        <div class="widget-content">
                            <div class="progress-info">
                                <div class="day-counter">
                                    <span class="current-day">Friday</span>
                                    <span class="total-days">10/10</span>
                                </div>
                                <div class="progress-percentage">0%</div>
                            </div>
                            <div class="progress-bar">
                                <div class="progress-fill" style="width: 0%"></div>
                            </div>
                            <div class="milestones">
                                <div class="milestone pending">
                                    <i class="far fa-circle"></i>
                                    <span>Waiting for Assignment</span>
                                </div>
                                <div class="milestone pending">
                                    <i class="far fa-circle"></i>
                                    <span>Team Formation</span>
                                </div>
                                <div class="milestone pending">
                                    <i class="far fa-circle"></i>
                                    <span>Project Kickoff</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="widget team-info">
                        <div class="widget-header">
                            <h3><i class="fas fa-users"></i> Team Information</h3>
                        </div>
                        <div class="widget-content">
                            <div class="team-details">
                                <div class="team-name">Team Assignment Pending</div>
                                <div class="team-members" id="teamMembers">
                                    <div style="color: #6b7280; font-size: 0.875rem;">Waiting for team formation...</div>
                                </div>
                                <div class="team-captain">
                                    <i class="fas fa-star"></i>
                                    <span>Team Captain: <span id="teamCaptain">TBD</span></span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="dashboard-center">
                    <div class="widget task-of-day">
                        <div class="widget-header">
                            <h3><i class="fas fa-tasks"></i> Task of the Day</h3>
                            <div class="task-priority high">WAITING</div>
                        </div>
                        <div class="widget-content">
                            <div class="task-content">
                                <h4 id="taskTitle">Waiting for Faculty to Assign Project</h4>
                                <p id="taskDescription">
                                    Please wait while the faculty sets up the consulting project and generates team assignments.
                                    Once assignments are ready, you will receive your specific client case and tasks.
                                </p>
                                <div class="task-deliverables">
                                    <h5>Current Status:</h5>
                                    <ul id="taskDeliverables">
                                        <li>Project assignment pending</li>
                                        <li>Team formation in progress</li>
                                        <li>Waiting for faculty instructions</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="widget ai-assistant">
                        <div class="widget-header">
                            <h3><i class="fas fa-robot"></i> AI Research Assistant</h3>
                            <button class="ai-toggle" id="aiToggle">
                                <i class="fas fa-expand"></i>
                            </button>
                        </div>
                        <div class="widget-content">
                            <div class="ai-chat" id="aiChat">
                                <div class="ai-message">
                                    <div class="ai-avatar">
                                        <i class="fas fa-robot"></i>
                                    </div>
                                    <div class="ai-text">
                                        Hello! I'm your AI research assistant. I can help you with market research, 
                                        analysis frameworks, and strategic thinking. What would you like to explore today?
                                    </div>
                                </div>
                            </div>
                            <div class="ai-input">
                                <input type="text" id="aiInput" placeholder="Ask me about research methods, frameworks, or analysis...">
                                <button id="aiSend" class="btn btn--primary">
                                    <i class="fas fa-paper-plane"></i>
                                </button>
                            </div>
                            <div class="ai-suggestions">
                                <button class="suggestion-btn" data-suggestion="market-research">Market Research Methods</button>
                                <button class="suggestion-btn" data-suggestion="competitive-analysis">Competitive Analysis</button>
                                <button class="suggestion-btn" data-suggestion="frameworks">Strategic Frameworks</button>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="dashboard-right">
                    <div class="widget performance-metrics">
                        <div class="widget-header">
                            <h3><i class="fas fa-chart-bar"></i> Performance Metrics</h3>
                        </div>
                        <div class="widget-content">
                            <div class="metric-item">
                                <div class="metric-label">Analytical Rigor</div>
                                <div class="metric-score">
                                    <span class="score">--</span>
                                    <div class="score-bar">
                                        <div class="score-fill" style="width: 0%"></div>
                                    </div>
                                </div>
                            </div>
                            <div class="metric-item">
                                <div class="metric-label">Strategic Thinking</div>
                                <div class="metric-score">
                                    <span class="score">--</span>
                                    <div class="score-bar">
                                        <div class="score-fill" style="width: 0%"></div>
                                    </div>
                                </div>
                            </div>
                            <div class="metric-item">
                                <div class="metric-label">Communication</div>
                                <div class="metric-score">
                                    <span class="score">--</span>
                                    <div class="score-bar">
                                        <div class="score-fill" style="width: 0%"></div>
                                    </div>
                                </div>
                            </div>
                            <div class="performance-feedback">
                                <h5>Latest Feedback:</h5>
                                <p>"Performance tracking will begin once project assignment is complete."</p>
                            </div>
                        </div>
                    </div>

                    <div class="widget deliverable-submission">
                        <div class="widget-header">
                            <h3><i class="fas fa-upload"></i> Deliverable Submission</h3>
                        </div>
                        <div class="widget-content">
                            <div class="submission-info">
                                <div class="deadline">
                                    <i class="fas fa-clock"></i>
                                    <span>Due: Pending Assignment</span>
                                </div>
                                <div class="time-remaining">
                                    <span class="countdown" id="deliverableCountdown">Waiting for tasks</span>
                                </div>
                            </div>
                            <div class="upload-area">
                                <div class="upload-box" id="uploadBox">
                                    <i class="fas fa-clock"></i>
                                    <p>Submission area will be available after project assignment</p>
                                    <input type="file" id="fileInput" multiple accept=".pdf,.doc,.docx,.ppt,.pptx,.xls,.xlsx" disabled>
                                </div>
                                <button class="btn btn--primary btn--full-width" id="submitDeliverable" disabled>
                                    Awaiting Assignment
                                </button>
                            </div>
                        </div>
                    </div>

                    <div class="widget activity-feed">
                        <div class="widget-header">
                            <h3><i class="fas fa-list"></i> Activity Feed</h3>
                        </div>
                        <div class="widget-content">
                            <div class="activity-list" id="activityList">
                                </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="adminPage" class="page">
        <div class="container admin-container">
            <div class="admin-header">
                <div class="header-left">
                    <div class="logo-small">
                        <i class="fas fa-graduation-cap"></i>
                        <span>SimuVerse</span>
                    </div>
                    <h2>Faculty Admin Panel</h2>
                </div>
                <div class="header-right">
                    <div class="user-info">
                        <span>Deepak Gupta</span>
                        <button id="adminLogout" class="btn btn--secondary">
                            <i class="fas fa-sign-out-alt"></i> Logout
                        </button>
                    </div>
                </div>
            </div>

            <div class="admin-content">
                <div class="widget session-control">
                    <div class="widget-header">
                        <h3><i class="fas fa-play-circle"></i> Session Control</h3>
                    </div>
                    <div class="widget-content">
                        <div class="session-stats">
                            <div class="stat-item">
                                <div class="stat-number" id="totalStudents">104</div>
                                <div class="stat-label">Total Students</div>
                            </div>
                            <div class="stat-item">
                                <div class="stat-number" id="onlineStudents">0</div>
                                <div class="stat-label">Online Now</div>
                            </div>
                            <div class="stat-item">
                                <div class="stat-number" id="activeTeams">0</div>
                                <div class="stat-label">Active Teams</div>
                            </div>
                        </div>
                        <div class="session-controls">
                            <button id="startSession" class="btn btn--primary">
                                <i class="fas fa-play"></i> Start Session
                            </button>
                            <button id="formTeams" class="btn btn--success" style="display: none;">
                                <i class="fas fa-users"></i> Form Teams
                            </button>
                            <button id="pauseSession" class="btn btn--warning" disabled>
                                <i class="fas fa-pause"></i> Pause Session
                            </button>
                            <button id="endSession" class="btn btn--danger" disabled>
                                <i class="fas fa-stop"></i> End Session
                            </button>
                        </div>
                    </div>
                </div>

                <div class="widget project-setup">
                    <div class="widget-header">
                        <h3><i class="fas fa-cogs"></i> Project Setup & Faculty Prompts</h3>
                    </div>
                    <div class="widget-content">
                        <div class="form-group">
                            <label>Project Prompt / Faculty Challenge Message</label>
                            <textarea id="projectPrompt" rows="4" placeholder="Enter project description for assignments OR instant challenge message for students (e.g., 'You have a meeting with the CEO in 5 minutes - prepare your elevator pitch!')"></textarea>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Project Duration (Days)</label>
                                <select id="projectDuration">
                                    <option value="3">3 Days</option>
                                    <option value="5" selected>5 Days</option>
                                    <option value="7">7 Days</option>
                                    <option value="10">10 Days</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>Team Size</label>
                                <select id="teamSize">
                                    <option value="3">3-4 Students</option>
                                    <option value="4">4-5 Students</option>
                                    <option value="5" selected>5-6 Students</option>
                                </select>
                            </div>
                        </div>
                        <div class="button-group">
                            <button class="btn btn--primary" id="generateAssignments">
                                <i class="fas fa-magic"></i> Generate Team Assignments
                            </button>
                            <button class="btn btn--secondary" id="manageTeamsManually">
                                <i class="fas fa-edit"></i> Manage Teams Manually
                            </button>
                            <button class="btn btn--warning" id="sendInstantChallenge">
                                <i class="fas fa-bullhorn"></i> Send Instant Challenge
                            </button>
                        </div>
                    </div>
                </div>

                <div class="widget student-management">
                    <div class="widget-header">
                        <h3><i class="fas fa-users-cog"></i> Student Management</h3>
                        <div class="widget-actions">
                            <input type="text" id="studentSearch" placeholder="Search students..." class="search-input">
                            
                            <button class="btn btn--success" id="declareResults">
                                <i class="fas fa-trophy"></i> Declare All Results
                            </button>
                            
                            <button class="btn btn--secondary" id="exportStudents">
                                <i class="fas fa-download"></i> Export
                            </button>
                        </div>
                    </div>
                    <div class="widget-content">
                        <div class="student-table-container">
                            <table class="student-table" id="studentTable">
                                <thead>
                                    <tr>
                                        <th>Name</th>
                                        <th>PRN</th>
                                        <th>Status</th>
                                        <th>Team</th>
                                        <th>Submission Status</th>
                                        <th>Performance</th>
                                        <th>Last Login</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody id="studentTableBody">
                                    </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <div class="widget monitoring">
                    <div class="widget-header">
                        <h3><i class="fas fa-monitor-heart-rate"></i> Real-time Monitoring</h3>
                    </div>
                    <div class="widget-content">
                        <div class="monitoring-grid">
                            <div class="monitor-item">
                                <h4>Active Students</h4>
                                <div class="active-students-list" id="activeStudentsList">
                                    </div>
                            </div>
                            <div class="monitor-item">
                                <h4>Team Progress</h4>
                                <div class="team-progress-list" id="teamProgressList">
                                    </div>
                            </div>
                            <div class="monitor-item">
                                <h4>Recent Activity</h4>
                                <div class="activity-monitor" id="activityMonitor">
                                    </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="challengePopup" class="popup-overlay hidden">
        <div class="popup-content">
            <div class="popup-header">
                <h3><i class="fas fa-exclamation-triangle"></i> Urgent Faculty Challenge</h3>
                <button class="popup-close" id="closeChallengePopup">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="popup-body">
                <div class="challenge-content" id="challengeContent">
                    </div>
            </div>
            <div class="popup-footer">
                <button class="btn btn--primary" id="acceptChallenge" onclick="document.getElementById('challengePopup').classList.add('hidden')">
                    <i class="fas fa-check"></i> Understood
                </button>
            </div>
        </div>
    </div>

    <script src="app-working.js"></script>

    <script>
      // Gemini API function to send prompt and get response
      async function callGeminiAPI(prompt) {
        const response = await fetch("https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash:generateContent", {
          method: "POST",
          headers: {
            "Content-Type": "application/json",
            // "x-goog-api-key": "YOUR_GEMINI_API_KEY" 
          },
          body: JSON.stringify({
            contents: [{ parts: [{ text: prompt }] }]
          })
        });
        const data = await response.json();
        return data;
      }

      // Public function for app-working.js to call
      async function processPrompt(prompt) {
        try {
            const result = await callGeminiAPI(prompt);
            // Safely access the response text
            const answer = (result?.candidates?.[0]?.content?.parts?.[0]?.text) 
                         ? result.candidates[0].content.parts[0].text
                         : "Error: No valid response from AI.";
            
            console.log("Gemini response received:", answer);
            return answer; // Return the answer to app-working.js

        } catch (error) {
            console.error("Error processing Gemini prompt:", error);
            return "Error: Could not connect to AI service.";
        }
      }
    </script>
</body>
</html>